<!DOCTYPE html>
<html>
<body>
<h2>Student Portal</h2>
<video id="video" autoplay></video>

<script>
const ws = new WebSocket("ws://localhost:8000/ws/student");
const video = document.getElementById("video");

navigator.mediaDevices.getUserMedia({ video: true })
.then(stream => video.srcObject = stream);

const canvas = document.createElement("canvas");
const ctx = canvas.getContext("2d");

ws.onopen = () => console.log(" Student WebSocket connected");

setInterval(() => {
  if (video.videoWidth === 0 || video.videoHeight === 0) return;

  canvas.width = video.videoWidth;
  canvas.height = video.videoHeight;

  ctx.drawImage(video, 0, 0);

  const imgData = canvas.toDataURL("image/jpeg", 0.7);
  const base64 = imgData.split(",")[1];

  if (base64) {
    ws.send(base64);
  }
}, 500);
</script>

</body>
</html>
